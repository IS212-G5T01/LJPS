<!DOCTYPE html>
<html class="wide wow-animation" lang="en">
  <head>
    <title>Update Skills</title>
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <!-- Stylesheets-->
    <link rel="stylesheet" type="text/css"
    href="//fonts.googleapis.com/css?family=Poppins:400,500,600%7CTeko:300,400,500%7CMaven+Pro:500">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
<link rel="stylesheet" href="../css/fonts.css">
<link rel="stylesheet" href="../css/style.css">
<link rel="stylesheet" href="../css/index.css">
  </head>
    <style> html.ie-10 .ie-panel, html.lt-ie-10 .ie-panel {display: block;}</style>
  </head>
  <body>

    <div class="preloader">
      <div class="preloader-body">
        <div class="cssload-container"><span></span><span></span><span></span><span></span>
        </div>
      </div>
    </div>
    <div class="page">
      <div id="home">
        <!-- Page Header-->
        <header class="section page-header">
            <!-- RD Navbar-->
            <div class="rd-navbar-wrap">
                <nav class="rd-navbar rd-navbar-classic" data-layout="rd-navbar-fixed"
                    data-sm-layout="rd-navbar-fixed" data-md-layout="rd-navbar-fixed"
                    data-md-device-layout="rd-navbar-fixed" data-lg-layout="rd-navbar-static"
                    data-lg-device-layout="rd-navbar-fixed" data-xl-layout="rd-navbar-static"
                    data-xl-device-layout="rd-navbar-static" data-xxl-layout="rd-navbar-static"
                    data-xxl-device-layout="rd-navbar-static" data-lg-stick-up-offset="46px"
                    data-xl-stick-up-offset="46px" data-xxl-stick-up-offset="46px" data-lg-stick-up="true"
                    data-xl-stick-up="true" data-xxl-stick-up="true">
                    <div class="rd-navbar-main-outer"
                    style="background-color: #668aff15">
                        <div class="rd-navbar-main">
                            <!-- RD Navbar Panel-->
                            <div class="rd-navbar-panel">
                                <!-- RD Navbar Toggle-->
                                <button class="rd-navbar-toggle"
                                    data-rd-navbar-toggle=".rd-navbar-nav-wrap"><span></span></button>
                                <!-- RD Navbar Brand-->
                                <div class="rd-navbar-brand"><a class="brand" href="HR_roles.html">
                                        <h3 style="margin-left: 80px;">LJPS</h3>
                                    </a></div>
                            </div>
                            <div class="rd-navbar-main-element">
                                <div class="rd-navbar-nav-wrap">
                                    <ul class="rd-navbar-nav">
                                        <li class="rd-nav-item "><a class="rd-nav-link text-decoration-none"
                                                href="HR_roles.html">HR
                                                Roles</a></li>
                                        <li class="rd-nav-item active"><a class="rd-nav-link text-decoration-none"
                                                href="skills.html">Skills</a>
                                        </li>
                                        <li class="rd-nav-item"><a class="rd-nav-link text-decoration-none"
                                                href="view_course.html">Courses</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </nav>
            </div>
        </header>
    </div>
    <div class="container mt-5 mb-5" >
          <div class="d-flex justify-content-center">
            <h3 id="s_name2"> </h3>
        </div>
        <div class="d-flex justify-content-center ms-0">
          <div class="btn-group border btn-toggle mt-3">
              <button class="btn btn-primary disabled" id="editrole">Editing Skill Information</button>
          </div>
      </div>
            <div class="row justify-content-center align-items-center h-100">
              <div class="col-12 col-lg-9 col-xl-7">
                <div class="card shadow-2-strong card-registration" style="border-radius: 15px;">
                  <div class="card-body p-4 p-md-5">
                    <form>
                        <div class="form-group mb-4 w-100">
                          <label for="skill_Name">Skill Name</label>
                          <input type="text" class="form-control" id="skill_Name" placeholder="Enter Skill Name" required>
                        </div>
                        <label for="role_status">Role Status</label>
                        <div id ="skill_status" class="mb-4">
                          <div class="form-check form-check-inline">
                              <input class="form-check-input" type="radio" name="inlineRadioOptions"
                                  id="inlineRadio1" value=1 checked>
                              <label class="form-check-label" for="inlineRadio1">Active</label>
                          </div>
                          <div class="form-check form-check-inline">
                              <input class="form-check-input" type="radio" name="inlineRadioOptions"
                                  id="inlineRadio2" value=0>
                              <label class="form-check-label" for="inlineRadio2">Inactive</label>
                          </div>
                      </div>
                        <div class="form-group mb-3 w-100">
                          <label for="skill_Description">Skill Description</label>
                          <textarea class="form-control" id="skill_Description" rows="3" placeholder="Enter Description" required></textarea>
                        </div>
                        <!-- <button type="submit" class="btn btn-primary" id="btn">Update</button> -->
                        <a class="btn btn-primary" href="./skills.html" role="button">Back</a>
                        <button id="update_btn" type="button" class="btn btn-primary" onclick="updateSkills()">Update</button>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
          <!-- Javascript-->
    <script>
        backendUrl = "http://127.0.0.1:5000";
        const queryString = window.location.search
        const urlParams = new URLSearchParams(queryString)
        const skill_id = urlParams.get('id')
        updateSkill = "updateSkill/" + skill_id;
        getSkills = "getskills";
        skillinfo = "getSkillById";

        const skill_Name = document.getElementById("skill_Name");
        const skill_Description = document.getElementById("skill_Description");
        const btn = document.getElementById("btn");

        //  put skill info inside the fields first
        async function getSkillInfo() {
          fetch(`${backendUrl}/${skillinfo}/${skill_id}`)
            .then((response) => response.json())
            .then((data) => {
              //console.log(data);
              if (data.code == 200) {
                document.getElementById("s_name2").innerText = " " + data.message[0].skill_name;
                skill_Name.value = data.message[0]["skill_name"];
                skill_Description.value = data.message[0]["skill_desc"];
                //console.log(data.message[0]["skill_status"])
                if (data.message[0]["skill_status"]== 0){
                  document.getElementById('inlineRadio1').checked= true
                }else{
                  document.getElementById('inlineRadio2').checked= true
                }
              }
            })
            .catch((error) => {
              console.error("Error:", error);
            });
        }
        async function updateSkills() {

          var a=document.getElementById("skill_Name").value
            var b=document.getElementById("skill_Description").value
                    if(a=='' || b==''){
                        alert("Please fill in all details")
                    }
                      else{
                        if (a.length > 50 && b.length > 255){
                              alert("Both skill name and description has reached the maximum characters.")
                        }else if(a.length >50){
                                alert("Update skill name has reached the maximum of 50 characters.")
                        }else if(b.length >255){
                                alert("Update skill description has reached the maximum of 255 characters.")
                        }else{
                            var active= document.getElementById("inlineRadio1");
                            if (active.checked){
                              var status = 0
                            }else{
                              var status = 1
                            }
                            fetch(`${backendUrl}/${updateSkill}`, {
                              method: "PUT",
                              headers: {
                                "Content-Type": "application/json",
                              },
                              body: JSON.stringify({
                                skill_name: document.getElementById("skill_Name").value,
                                skill_desc: document.getElementById("skill_Description").value,
                                skill_status: status
                              }),
                            })
                              .then((response) => response.json())
                              .then((data) => {
                                //console.log("Success:", data);
                                if (data.code == 200) {
                                  alert('Updated successfully!')
                                  location.reload();
                                }
                                else{
                                  alert("Skill name already exists!");
                                }
                              })
                              .catch((error) => {
                                console.error("Error:", error);
                              });
                            }
                        }
                      }
          getSkillInfo();

        // const myData = function (getAllSkills) {
        // 	getid = 1;
        // 	for (const listskills of getAllSkills) {
        // 		// if(skillID.value )
        // 		console.log(listskills["skill_id"]);
        // 	}
        // 	console.log("id:", getid);
        // 	return getid;
        // };

        // async function getAllSkills() {
        // 	const response = await fetch(`${backendUrl}/${getSkills}`)
        // 		.then((response) => response.json())
        // 		.then((data) => {
        // 			// console.log(JSON.parse(JSON.stringify(data.data)));
        // 			result = JSON.parse(JSON.stringify(data.data.skill));
        // 			message_str = `
        // 		<thead>
        // 		<tr class="bg-light">
        // 		<th scope="col">Skill ID</th>
        // 		<th scope="col">Skill Name</th>
        // 		<th scope="col">Skill Description</th>
        // 		</tr>
        // 		</thead>`;
        // 			for (const skill of result) {
        // 				if (skill["skill_status"] == 0) {
        // 					message_str += `
        // 				<tbody>
        // 				<tr>
        // 				<th scope="row">${skill["skill_id"]}</th>
        // 				<td>${skill["skill_name"]}</td>
        // 				<td class="text-wrap w-50">${skill["skill_desc"]}</td>
        // 				</tr>
        // 				</tbody>
        // 				`;
        // 				}
        // 			}
        // 			document.getElementById("table").innerHTML = message_str;
        // 			// console.log(data.data.skill["skill_id"]);
        // 			return data.data.skill;
        // 		})
        // 		.then(myData)
        // 		.catch((error) => {
        // 			// Errors when calling the service; such as network error,
        // 			// service offline, etc
        // 			console.log(error);
        // 		});
        // }
        // getAllSkills();
    </script>
    <script src="../js/core.min.js"></script>
    <script src="../js/script.js"></script>
  </body>
</html>