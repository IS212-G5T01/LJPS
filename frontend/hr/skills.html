<!DOCTYPE html>
<html class="wide wow-animation" lang="en">

  <head>
    <title>Skills</title>
    <meta name="format-detection" content="telephone=no">
    <meta name="viewport"
      content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <!-- Stylesheets-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css"
      href="//fonts.googleapis.com/css?family=Poppins:400,500,600%7CTeko:300,400,500%7CMaven+Pro:500">
    <!-- <link rel="stylesheet" href="css/bootstrap.css"> -->
    <link rel="stylesheet" href="../css/fonts.css">
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/index.css">
  </head>

<body>

    <div class="preloader">
      <div class="preloader-body">
        <div class="cssload-container"><span></span><span></span><span></span><span></span>
        </div>
      </div>
    </div>
    <div class="page">
      <div id="home">
        <!-- Page Header-->
        <header class="section page-header">
          <!-- RD Navbar-->
          <div class="rd-navbar-wrap">
            <nav class="rd-navbar rd-navbar-classic" data-layout="rd-navbar-fixed" data-sm-layout="rd-navbar-fixed"
              data-md-layout="rd-navbar-fixed" data-md-device-layout="rd-navbar-fixed" data-lg-layout="rd-navbar-static"
              data-lg-device-layout="rd-navbar-fixed" data-xl-layout="rd-navbar-static"
              data-xl-device-layout="rd-navbar-static" data-xxl-layout="rd-navbar-static"
              data-xxl-device-layout="rd-navbar-static" data-lg-stick-up-offset="46px" data-xl-stick-up-offset="46px"
              data-xxl-stick-up-offset="46px" data-lg-stick-up="true" data-xl-stick-up="true" data-xxl-stick-up="true">
              <div class="rd-navbar-main-outer"
                  style="background-color: #668aff15">
                <div class="rd-navbar-main">
                  <!-- RD Navbar Panel-->
                  <div class="rd-navbar-panel">
                    <!-- RD Navbar Toggle-->
                    <button class="rd-navbar-toggle" data-rd-navbar-toggle=".rd-navbar-nav-wrap"><span></span></button>
                    <!-- RD Navbar Brand-->
                    <div class="rd-navbar-brand"><a class="brand" href="index.html">
                        <h3 style="margin-left: 80px;">LJPS</h3>
                      </a></div>
                  </div>
                  <div class="rd-navbar-main-element">
                    <div class="rd-navbar-nav-wrap">
                      <ul class="rd-navbar-nav">
                        <li class="rd-nav-item"><a class="rd-nav-link text-decoration-none" href="HR_roles.html">HR
                            Roles</a></li>
                        <li class="rd-nav-item active"><a class="rd-nav-link text-decoration-none"
                            href="skills.html">Skills</a></li>
                        <li class="rd-nav-item"><a class="rd-nav-link text-decoration-none" href="view_course.html">Courses</a></li>
                        <li class="rd-nav-item"><a class="rd-nav-link text-decoration-none"
                            href="#">Learners</a></li>
                        <li class="rd-nav-item"><a class="rd-nav-link text-decoration-none" href="">Profile</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </nav>
          </div>
        </header>
      </div>
      <!-- Main content starts here  -->
  <div class="container mt-5 mb-5">
          <h3>List of Skills</h3>
      
          <div class="mb-0 d-flex justify-content-end">
            <button type="button" class="btn btn-primary" onclick="window.location.href='./skills_form.html'">Create
              New Skill</button>
          </div>
          <div class="alert alert-danger mt-5" id="res" role="alert">
					
				  </div>
          <table class="table borderless table-hover mt-5" id="table">
          </table>
      
      </div>
   
      <script>
          var backendUrl = 'http://127.0.0.1:5000';
          var getskills = 'getskills';
          var deleteSkill = 'deleteSkill';

          async function removeSkill(id) {
              console.log(`${backendUrl}/${deleteSkill}/${id}`);
              fetch(`${backendUrl}/${deleteSkill}/${id}`, {
                      method: 'DELETE'
                  })
                  .then((response) => response.json())
                  .then((data) => {
                      alert("Deleted skill successfully");
                      location.reload();

                  })
                  .catch((error) => {
                      // Errors when calling the service; such as network error,
                      // service offline, etc
                      console.log(error);
                  });
          }
          async function getAllSkills(){
              const response =
                  await fetch(`${backendUrl}/${getskills}`)
                      .then(response => response.json())
                      .then(data => {
                        console.log(data)
                        if (JSON.parse(JSON.stringify(data.code)==404)){
							document.getElementById("res").innerText="No records found"
						}

            else{

           document.getElementById("res").style.display= "none";
                          result =JSON.parse(JSON.stringify(data.data.skill))
                          message_str =  `
                          <thead>
                              <tr class="bg-light">
                              <th class="align-middle" scope="col">Skill Name</th>
                              <th class="align-middle" scope="col">Skill Description</th>
                              <th class="align-middle" scope="col">Skill Status</th>
                              <th class="align-middle" scope="col">Action</th>
                              </tr>
                          </thead>`
                          for (const skill of result) {
                            if(skill['skill_status'] == 0){
                              var status = "Active"
                            }else{
                              var status = "Inactive"
                            }
                            message_str += `
                            <tbody>
                                <tr>
                                    <th class="align-middle text-wrap" scope="row">${skill['skill_name']}</th>
                                    <td class="align-middle text-wrap w-50">${skill['skill_desc']}</td>
                                    <td class="align-middle text-wrap">${status}</td>
                                    <td class="align-middle text-wrap w-25"> 
                                    <button type="button" class="btn btn-primary" >View Course</button>
                                    <button type="button" class="btn btn-success" onClick="location.href='./updateskills.html?id=${skill['skill_id']}'">Edit</button>
                                    <button type="button" class="btn btn-danger" onClick="removeSkill(${skill['skill_id']})" >Delete</button>
                                    </td>
                                </tr>
                            </tbody>
                                  `
                          }
                          document.getElementById('table').innerHTML = message_str
                          return data.data.skill }
                      })
                      .catch(error => {
                          // Errors when calling the service; such as network error, 
                          // service offline, etc
                          console.log(error);
                      });
          }
          getAllSkills()
      </script>
      <!-- Javascript-->
      <script src="../js/core.min.js"></script>
      <script src="../js/script.js"></script>
 
</body>

</html>